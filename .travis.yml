language: android
components:
  - build-tools-26.0.3
  - android-26
  - extra-google-google_play_services
  - extra-google-m2repository
  - extra-android-m2repository
  - addon-google_apis-google-26
licenses:
  - 'android-sdk-preview-license-52d11cd2'
  - 'android-sdk-license-.+'
  - 'google-gdk-license-.+'
jdk: oraclejdk8
cache: yarn
before_install:
- nvm install 10.0.0
- node --version
- npm i yarn


addons: 
  apt:
  sources:
  - sourceline:  'deb https://dl.yarnpkg.com/debian/ stable main'
    key_url: 'https://dl.yarnpkg.com/debian/pubkey.gpg'
    packages:
      - yarn


install:
- yarn install 

script:
- npm run format-code

before_deploy:
  - cd android && ./gradlew assembleRelease

deploy:
  provider: release
  skip_cleanup: true
  api_key:
    secure: 
  file: $TRAVIS_BUILD_DIR/android/app/build/outputs/apk/app-release.apk
  on:
    repo: haitaodesign/LeeCCApp
    tags: true